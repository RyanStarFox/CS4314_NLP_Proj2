import streamlit as st
import base64
import os
import sys

# Fix path to allow importing modules from root
sys.path.append(os.getcwd())
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))

import streamlit.components.v1 as components
import ui_components

# Inject JS for keyboard shortcut (Cmd/Ctrl + ,)
components.html("""
<script>
document.addEventListener('keydown', function(e) {
    if ((e.metaKey || e.ctrlKey) && (e.key === ',' || e.keyCode === 188)) {
        e.preventDefault();
        window.top.postMessage({type: 'open-settings'}, '*');
    }
}, true);
</script>
""", height=0, width=0)

st.set_page_config(page_title="ä½¿ç”¨è¯´æ˜", page_icon="logo.png", layout="wide")

st.markdown(f"""
<style>
    .block-container {{ padding-top: 2rem; }}
    img {{ image-rendering: -webkit-optimize-contrast; }}
    
    /* Sidebar Styles from ui_components */
    {ui_components.get_sidebar_css()}
</style>
""", unsafe_allow_html=True)

# sidebar
ui_components.render_sidebar()

# Custom CSS for card styling
# Initialize navigation state
if 'help_section' not in st.session_state:
    st.session_state.help_section = None

# Base CSS (Always applies)
st.markdown("""
<style>
    .block-container { padding-top: 2rem; }
    img { image-rendering: -webkit-optimize-contrast; }
    
    .instruction-card {
        background-color: var(--secondary-background-color);
        border: 1px solid rgba(128, 128, 128, 0.2);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 10px;
        width: 100%;
        height: 100%;
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
    }
    
    .instruction-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        border-color: #FF4B4B;
    }
    
    .card-icon {
        font-size: 2.5rem;
        margin-bottom: 8px;
        display: block;
    }
    
    .card-title {
        font-size: 1.15rem;
        font-weight: 600;
        margin-bottom: 6px;
        color: var(--text-color);
    }
    
    .card-desc {
        font-size: 0.85rem;
        color: #888;
        line-height: 1.35;
        min-height: 3.2em;
    }
    
    .feature-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin: 20px 0;
        color: #FF4B4B;
    }
    
    .step-item {
        background-color: rgba(128, 128, 128, 0.05);
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 8px;
        border-left: 3px solid #FF4B4B;
    }

</style>
""", unsafe_allow_html=True)

# Conditional CSS for Home View Only (Fixed Layout)
if st.session_state.help_section is None:
    st.markdown("""
    <style>
        /* æ ¸å¿ƒå¸ƒå±€è°ƒæ•´ï¼šæ¶ˆé™¤æ»šåŠ¨æ¡ - ä»…åœ¨å¯¼èˆªé¡µç”Ÿæ•ˆ */
        .block-container { 
            padding-bottom: 0rem;
        }
        
        /* ä»…éšè— Streamlit é¡µè„š, ä¿ç•™ header ä»¥ä¾¿ä¾§è¾¹æ æŒ‰é’®æ­£å¸¸å·¥ä½œ */
        footer {display: none;}
    </style>
    """, unsafe_allow_html=True)

# Header
st.title("ğŸ“š ä½¿ç”¨è¯´æ˜ä¹¦")
st.caption("ç‚¹å‡»ä¸‹æ–¹å¡ç‰‡æŸ¥çœ‹è¯¦ç»†åŠŸèƒ½è¯´æ˜")
st.markdown("---")

# Main Navigation Grid
if st.session_state.help_section is None:
    # Feature configurations
    features = [
        {
            "id": "ai_tutor",
            "icon": "ğŸ§ ",
            "title": "æ™ºèƒ½åŠ©æ•™",
            "desc": "æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Œè§£ç­”ç–‘é—®ï¼Œæä¾›æ¥æº"
        },
        {
            "id": "practice",
            "icon": "ğŸ“",
            "title": "åšé¢˜ç»ƒä¹ ",
            "desc": "è‡ªåŠ¨ç”Ÿæˆé¢˜ç›®ï¼ŒAI æ‰¹æ”¹ï¼Œæä¾›è§£æ"
        },
        {
            "id": "mistakes",
            "icon": "ğŸ““",
            "title": "é”™é¢˜æ•´ç†",
            "desc": "è‡ªåŠ¨æˆ–æ‰‹åŠ¨ç®¡ç†é”™é¢˜ï¼Œç»ƒä¹ é”™é¢˜"
        },
        {
            "id": "outline",
            "icon": "ğŸ“‘",
            "title": "å¤§çº²ç”Ÿæˆ",
            "desc": "åˆ†æçŸ¥è¯†åº“ç”Ÿæˆçš„å¤ä¹ å¤§çº²"
        },
        {
            "id": "kb",
            "icon": "ğŸ“š",
            "title": "çŸ¥è¯†åº“ç®¡ç†",
            "desc": "ä¸Šä¼ å’Œç®¡ç†è¯¾ç¨‹èµ„æ–™"
        },
        {
            "id": "settings",
            "icon": "âš™ï¸",
            "title": "ç³»ç»Ÿè®¾ç½®",
            "desc": "API é…ç½®ã€æ¨¡å‹é€‰æ‹©ã€å‚æ•°é…ç½®"
        }
    ]

    # Render grid (3 columns)
    cols = st.columns(3)
    for i, feature in enumerate(features):
        with cols[i % 3]:
            # Create a clickable card using st.button
            # Note: We use a little CSS hack to make the button look like a card
            # Or simpler: Just use container + button
            with st.container(border=True):
                st.markdown(f"""
                <div style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 10px;">{feature['icon']}</div>
                    <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 5px;">{feature['title']}</div>
                    <div style="color: #666; font-size: 0.9rem; min-height: 40px;">{feature['desc']}</div>
                </div>
                """, unsafe_allow_html=True)
                if st.button("æŸ¥çœ‹è¯¦æƒ…", key=f"btn_{feature['id']}", use_container_width=True):
                    st.session_state.help_section = feature['id']
                    st.rerun()

    # Footer
    st.markdown("---")
    st.markdown("""
    <div style="text-align: center; color: #888; font-size: 0.8rem;">
        CS4314 æ™ºèƒ½è¯¾ç¨‹åŠ©æ•™ç³»ç»Ÿ v2.0
    </div>
    """, unsafe_allow_html=True)

else:
    # Detail View
    if st.button("â† è¿”å›åŠŸèƒ½åˆ—è¡¨"):
        st.session_state.help_section = None
        st.rerun()
    
    section = st.session_state.help_section
    
    if section == "ai_tutor":
        st.header("ğŸ§  æ™ºèƒ½åŠ©æ•™ï¼šä½ çš„ 24 å°æ—¶ä¸“å±è¡¥ä¹ è€å¸ˆ")
        st.info("ğŸ’¡ æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰ä¸€ä½è¿‡ç›®ä¸å¿˜çš„å­¦éœ¸åŒæ¡Œï¼Œä»–èƒŒä¸‹äº†ä½ æ‰€æœ‰çš„è¯¾æœ¬å’Œ PPTï¼Œéšæ—¶å‡†å¤‡å›ç­”ä½ çš„é—®é¢˜ã€‚è¿™å°±æ˜¯ã€Œæ™ºèƒ½åŠ©æ•™ã€ã€‚")

        st.markdown("### ğŸ”¥ å®ƒå¯ä»¥å¸®ä½ åšä»€ä¹ˆï¼Ÿ")
        col1, col2 = st.columns([1, 1])
        with col1:
             st.markdown("""
             **1. å“ªé‡Œä¸ä¼šé—®å“ªé‡Œ**
             * é‡åˆ°ä¸æ‡‚çš„æ¦‚å¿µï¼ˆæ¯”å¦‚â€œä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Ÿâ€ï¼‰ï¼Œç›´æ¥é—®å®ƒã€‚å®ƒä¼šç”¨é€šä¿—æ˜“æ‡‚çš„è¯ç»™ä½ è®²æ˜ç™½ã€‚
             * **ç²¾å‡†å®šä½**ï¼šå®ƒä¸ä»…å‘Šè¯‰ä½ ç­”æ¡ˆï¼Œè¿˜ä¼šå‘Šè¯‰ä½ è¿™ä¸ªçŸ¥è¯†ç‚¹åœ¨è¯¾æœ¬çš„ **ç¬¬å‡ é¡µ**ï¼Œæ–¹ä¾¿ä½ å›å»æŸ¥é˜…ã€‚
             
             **2. çœ‹å›¾è¯´è¯ (å¤šæ¨¡æ€èƒ½åŠ›)**
             * é‡åˆ°çœ‹ä¸æ‡‚çš„ **ç‰©ç†å…¬å¼æˆªå›¾**ï¼Ÿ
             * é‡åˆ°å¤æ‚çš„ **ç”Ÿç‰©æµç¨‹å›¾**ï¼Ÿ
             * ç›´æ¥æŠŠå›¾ç‰‡å‘ç»™å®ƒï¼Œå¹¶åœ¨è¾“å…¥æ¡†é—®ï¼šâ€œè¯·è§£é‡Šä¸€ä¸‹è¿™å¼ å›¾æ˜¯ä»€ä¹ˆæ„æ€â€ï¼Œå®ƒå°±èƒ½çœ‹æ‡‚å¹¶ç»™ä½ è®²è§£ã€‚
             """)
        with col2:
             st.markdown("""
             **3. è·¨ç« èŠ‚ä¸²è”çŸ¥è¯†**
             * å®ƒå¯ä»¥åŒæ—¶å‚è€ƒç¬¬ä¸€ç« å’Œç¬¬äº”ç« çš„å†…å®¹ï¼Œå¸®ä½ æ€»ç»“çŸ¥è¯†ç‚¹ä¹‹é—´çš„è”ç³»ã€‚
             * æ¯”å¦‚é—®ï¼šâ€œè¿™ä¸€ç« æåˆ°çš„ç†è®ºå’Œä¹‹å‰å­¦çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâ€
             
             **4. åƒèŠå¤©ä¸€æ ·å­¦ä¹ **
             * æ²¡å¬æ‡‚ï¼Ÿæ²¡å…³ç³»ï¼Œæ¥ç€é—®ï¼šâ€œèƒ½å†ç®€å•ç‚¹è§£é‡Šå—ï¼Ÿâ€æˆ–è€…â€œèƒ½ä¸¾ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­å—ï¼Ÿâ€
             * å®ƒè®°å¾—ä½ ä»¬ä¹‹å‰çš„å¯¹è¯ï¼Œå°±åƒçœŸçš„åœ¨èŠå¤©ä¸€æ ·ã€‚
             """)
        
        st.markdown("---")
        st.markdown("### ğŸ“ æé—®å°è´´å£«")
        st.success("ğŸŒŸ ç§˜è¯€ï¼šæŠŠé—®é¢˜é—®å¾—è¶Šå…·ä½“ï¼Œå¾—åˆ°çš„ç­”æ¡ˆå°±è¶Šå¥½ï¼æ¯”å¦‚ï¼š\n\nâŒ â€œè®²è®²åŠ›å­¦â€\nâœ… â€œè¯·ç»“åˆ Lecture 3 çš„å†…å®¹ï¼Œè§£é‡Šä¸€ä¸‹ç‰›é¡¿ç¬¬äºŒå®šå¾‹åœ¨æ–œé¢æ»‘å—é—®é¢˜ä¸­çš„åº”ç”¨â€")

    elif section == "practice":
        st.header("ğŸ“ æ™ºèƒ½åˆ·é¢˜ï¼šè€ƒå‰è‡ªæµ‹ç¥å™¨")
        st.info("ğŸ’¡ æ— è®ºæ˜¯æœŸä¸­è€ƒè¿˜æ˜¯æœŸæœ«è€ƒï¼Œâ€œåˆ·é¢˜â€æ°¸è¿œæ˜¯æœ€æœ‰æ•ˆçš„å¤ä¹ æ–¹å¼ã€‚è¿™é‡Œæœ‰ä½ çš„ä¸“å±é¢˜åº“ã€‚")
        
        col1, col2 = st.columns(2)
        with col1:
            st.markdown("### ğŸ¯ æ€ä¹ˆå¼€å§‹åˆ·é¢˜ï¼Ÿ")
            st.markdown("""
            **æ¨¡å¼ä¸€ï¼šé’ˆå¯¹å¤ä¹  (çŸ¥è¯†åº“è‡ªæµ‹)**
            * æ¯”å¦‚æ˜å¤©è¦è€ƒâ€œç¬¬ä¸‰ç« â€ï¼Œä½ å°±é€‰æ‹©â€œç¬¬ä¸‰ç« â€çš„çŸ¥è¯†åº“ã€‚
            * AI ä¼šç°åœºé˜…è¯»è¿™ä¸€ç« çš„æ–‡æ¡£ï¼Œä¸ºä½ â€œç°ç¼–â€é¢˜ç›®ï¼Œç¡®ä¿è€ƒç‚¹è¦†ç›–å…¨ã€‚
            
            **æ¨¡å¼äºŒï¼šç»¼åˆæ¨¡æ‹Ÿ (é¢˜åº“æ¨¡å¼)**
            * å¦‚æœä½ å·²ç»å¯¼å…¥äº†å†å¹´çœŸé¢˜åº“ï¼Œé€‰æ‹©å®ƒï¼Œç³»ç»Ÿä¼šéšæœºæŠ½é¢˜ï¼Œæ¨¡æ‹ŸçœŸå®è€ƒè¯•çš„æ„Ÿè§‰ã€‚
            """)
        
        with col2:
            st.markdown("### ğŸ“Š åšå®Œé¢˜èƒ½å¾—åˆ°ä»€ä¹ˆï¼Ÿ")
            st.markdown("""
            * **ç§’å‡ºæˆç»©**ï¼šç‚¹ä¸€ä¸‹é€‰é¡¹ï¼Œç«‹é©¬å‘Šè¯‰ä½ å¯¹é”™ï¼ˆç»¿è‰²âœ…/çº¢è‰²âŒï¼‰ã€‚
            * **è¶…çº§è§£æ**ï¼š
              * é€‰å¯¹äº†ï¼Ÿå®ƒä¼šå¤¸ä½ å¹¶å·©å›ºä¸€ä¸‹çŸ¥è¯†ç‚¹ã€‚
              * **é€‰é”™äº†ï¼Ÿ**è¿™æ˜¯é‡ç‚¹ï¼å®ƒä¼šè¯¦ç»†å‘Šè¯‰ä½ **ä¸ºä»€ä¹ˆé€‰é”™**ï¼Œä»¥åŠæ­£ç¡®ç­”æ¡ˆçš„æ¨ç†è¿‡ç¨‹ã€‚
            * **è‡ªåŠ¨æ”¶é›†**ï¼šåšé”™çš„é¢˜ä¼šè‡ªåŠ¨é£è¿›ä½ çš„ã€Œé”™é¢˜æœ¬ã€ï¼Œä¸ç”¨ä½ æ‰‹åŠ¨æŠ„å†™ã€‚
            """)

    elif section == "mistakes":
        st.header("ğŸ““ é”™é¢˜æœ¬ï¼šæ¶ˆç­ä½ çš„çŸ¥è¯†ç›²åŒº")
        st.info("ğŸ’¡ ä¿—è¯è¯´â€œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´â€ï¼Œä½†ç°åœ¨ä¸éœ€è¦ç¬”å¤´äº†ï¼ŒAI å¸®ä½ è‡ªåŠ¨æ•´ç†ã€‚")
        
        col1, col2 = st.columns(2)
        with col1:
            st.markdown("### ğŸš€ æŠŠé”™é¢˜è£…è¿›ç¯®å­é‡Œ")
            st.markdown("""
            **1. è‡ªåŠ¨åŒæ­¥**
            * ä½ åœ¨â€œåšé¢˜ç»ƒä¹ â€é‡Œåšé”™çš„æ¯ä¸€é“é¢˜ï¼Œéƒ½ä¼šè‡ªåŠ¨å‡ºç°åœ¨è¿™é‡Œã€‚
            
            **2. æ‹ç…§åŠå½•å…¥ (é»‘ç§‘æŠ€ï¼)**
            * è¯•å·å‘ä¸‹æ¥äº†ï¼Œåªæœ‰å‡ é“é¢˜åšé”™äº†ï¼Œä¸æƒ³æŠ„ï¼Ÿ
            * ç‚¹å‡» **â€œâ• æ‰‹åŠ¨æ·»åŠ â€** -> **ä¸Šä¼ ç…§ç‰‡**ã€‚
            * ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ä¸Šçš„æ–‡å­—ï¼ˆOCRï¼‰ï¼ŒæŠŠé¢˜ç›®å’Œé€‰é¡¹å˜æˆç”µå­ç‰ˆå­˜è¿›å»ã€‚ä½ åªéœ€è¦åŠ¨åŠ¨æ‰‹æŒ‡å¾®è°ƒä¸€ä¸‹ã€‚
            """)

        with col2:
            st.markdown("### ğŸ”„ ç§‘å­¦å¤ä¹ æ³•")
            st.markdown("""
            ç³»ç»Ÿä¼šç»™æ¯ä¸ªé”™é¢˜æ‰“ä¸Šæ ‡ç­¾ï¼š
            * ğŸ”´ **é™Œç”Ÿ**ï¼šåˆšåˆšåšé”™ï¼Œæˆ–è€…å¾ˆä¹…æ²¡å¤ä¹ çš„é¢˜ã€‚**ä¼˜å…ˆå¤ä¹ è¿™äº›ï¼**
            * ğŸŸ¡ **æ¨¡ç³Š**ï¼šæœ‰ç‚¹å°è±¡ï¼Œä½†åœ¨è¿™ä¸ªå‘é‡Œæ‘”è¿‡å„è·¤ã€‚
            * ğŸŸ¢ **æŒæ¡**ï¼šå·²ç»å®Œå…¨ææ‡‚äº†ã€‚å¯ä»¥æŠŠå®ƒç§»è¿›â€œå½’æ¡£ç®±â€ï¼Œçœ¼ä¸è§å¿ƒä¸çƒ¦ã€‚
            """)

    elif section == "outline":
        st.header("ğŸ“‘ å¤§çº²ç”Ÿæˆï¼šä¸€é”®æŠŠä¹¦è¯»è–„")
        st.info("ğŸ’¡ é¢å¯¹å‡ ç™¾é¡µçš„ PPT å¤´å¤§å—ï¼Ÿè¿™ä¸ªåŠŸèƒ½å¸®ä½ æŠŠâ€œç –å¤´â€å˜æˆâ€œè–„è–„çš„å‡ é¡µçº¸â€ã€‚")
        
        col1, col2 = st.columns(2)
        with col1:
            st.markdown("### ğŸŒŸ é­”æ³•æ­¥éª¤")
            st.markdown(""" 
            1. é€‰æ‹©ä½ è¦å¤ä¹ çš„èµ„æ–™åŒ…ï¼ˆæ¯”å¦‚â€œæœŸæœ«æ€»å¤ä¹ â€ï¼‰ã€‚
            2. ç‚¹å‡» **â€œç”Ÿæˆå¤§çº²â€** æŒ‰é’®ã€‚
            3. ç­‰å¾…å‡ åç§’... âœ¨
            4. ä½ ä¼šå¾—åˆ°ä¸€ä»½ç»“æ„æ¸…æ™°ã€é‡ç‚¹çªå‡ºçš„ **å¤ä¹ æçº²**ï¼ŒåŒ…å«äº†æ ¸å¿ƒå®šä¹‰ã€å…¬å¼å’Œå…³é”®ç»“è®ºã€‚
            """)
            
        with col2:
            st.markdown("### âœï¸ å®ƒæ˜¯å¬è¯çš„")
            st.markdown("""
            è§‰å¾—ç”Ÿæˆçš„å¤§çº²å¤ªç®€å•ï¼Ÿæˆ–è€…æ¼äº†ä»€ä¹ˆï¼Ÿ
            åœ¨å³è¾¹çš„æ¡†é‡Œå‘Šè¯‰å®ƒï¼š
            > "è¯·æŠŠå…³äºâ€˜å…‰åˆä½œç”¨â€™çš„é‚£ä¸€èŠ‚å†™å¾—è¯¦ç»†è¿™ä¸€æ³¢ï¼Œæœ€å¥½åŠ ä¸Šååº”å…¬å¼ã€‚"
            
            AI ä¼šé©¬ä¸Šé‡æ–°ä¿®æ”¹å¤§çº²ï¼Œç›´åˆ°ä½ æ»¡æ„ä¸ºæ­¢ã€‚
            æœ€åï¼Œä½ å¯ä»¥æŠŠå®ƒ **å¤åˆ¶** ä¸‹æ¥ï¼Œæ‰“å°æˆ–è€…å­˜åˆ°ä½ çš„ç¬”è®°è½¯ä»¶é‡Œã€‚
            """)

    elif section == "kb":
        st.header("ğŸ“š çŸ¥è¯†åº“ç®¡ç†ï¼šæŠ•å–‚ AI çš„å¤§è„‘")
        st.info("ğŸ’¡ è¿™é‡Œæ˜¯ AI çš„â€œå›¾ä¹¦é¦†â€ã€‚å¿…é¡»å®Œæˆä¸‹é¢ **ä¸¤æ­¥**ï¼ŒAI æ‰èƒ½å­¦ä¼šä½ çš„è¯¾ä»¶ã€‚")
        
        c1, c2 = st.columns(2)
        
        with c1:
            st.markdown("### ğŸ“‚ ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ èµ„æ–™")
            st.info("å…ˆæŠŠä¹¦æ”¾è¿›ä¹¦æ¶")
            st.markdown("""
            **1. æ‰“å¼€æ–‡ä»¶å¤¹**
            ç‚¹å‡» **â€œğŸ“‚ æ‰“å¼€æœ¬åœ°æ–‡ä»¶å¤¹â€** æŒ‰é’®ã€‚ç³»ç»Ÿä¼šå¼¹å‡ºä¸€ä¸ªæ–‡ä»¶å¤¹çª—å£ã€‚
            
            **2. æ‹–å…¥æ–‡ä»¶**
            æŠŠä½ çš„è¯¾ä»¶ (`PDF`, `PPT`, `Word`) ç›´æ¥ **æ‹–** è¿›è¿™ä¸ªçª—å£é‡Œã€‚
            
            **ğŸ’¡ å°å»ºè®®**
            æ–‡ä»¶åå†™æ¸…æ¥šç‚¹ï¼Œæ¯”å¦‚ã€Šç‰©ç†-ç¬¬ä¸€ç« .pdfã€‹ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚
            """)
            
        with c2:
            st.markdown("### âš¡ï¸ ç¬¬äºŒæ­¥ï¼šå»ºç«‹ç´¢å¼•")
            st.error("âš ï¸ å¿…é¡»åšè¿™ä¸€æ­¥ï¼Œå¦åˆ™ AI çœ‹ä¸è§ï¼")
            st.markdown("""
            **åŠ¨ä½œ Aï¼šâš¡ï¸ æ›´æ–°å¢é‡ç´¢å¼• (æ¨è)**
            * **åªéœ€ 3 ç§’**ã€‚
            * å‘Šè¯‰ AIï¼šâ€œæˆ‘åˆšæ”¾äº†å‡ æœ¬æ–°ä¹¦ï¼Œä½ å¿«è¯»ä¸€ä¸‹ã€‚â€
            * é€‚åˆæ—¥å¸¸åŠ å‡ ä¸ªæ–‡ä»¶ã€‚
            * åˆ é™¤æ–‡ä»¶ä¹Ÿéœ€è¦æ›´æ–°ç´¢å¼•å“¦ï½
            
            **åŠ¨ä½œ Bï¼šğŸ”„ é‡å»ºçŸ¥è¯†åº“ç´¢å¼•**
            * **å½»åº•é‡è¯»**ã€‚
            * å‘Šè¯‰ AIï¼šâ€œæŠŠä»¥å‰è®°çš„éƒ½å¿˜æ‰ï¼Œé‡æ–°è¯»ä¸€éã€‚â€
            * é€‚åˆå‡ºé”™äº†æˆ–è€…æƒ³é‡ç½®çš„æ—¶å€™ã€‚
            """)

    elif section == "settings":
        st.header("âš™ï¸ ç³»ç»Ÿè®¾ç½®ï¼šæ§åˆ¶å®¤")
        st.markdown("è¿™é‡Œæ˜¯ç»™é«˜çº§ç©å®¶å‡†å¤‡çš„ï¼Œé€šå¸¸æƒ…å†µä¸‹é»˜è®¤è®¾ç½®è¿™å°±å¤Ÿç”¨äº†ã€‚")
        
        c1, c2 = st.columns(2)

        with c1:
            st.subheader("AIæ¨¡å‹é…ç½® (é‡è¦)")
            st.markdown("""
            * **API Key (å¯†é’¥)**ï¼š
            * å°±åƒä½ å®¶é—¨çš„**é’¥åŒ™**ã€‚æ²¡æœ‰å®ƒï¼Œè¿›ä¸å» AI çš„å¤§é—¨ã€‚è¯·åœ¨å¯¹åº”çš„å®˜ç½‘ï¼ˆå¦‚ DeepSeek, OpenAIï¼‰ç”³è¯·ã€‚
            
            * **Base URL (æœåŠ¡åœ°å€)**ï¼š
            * AI ä½åœ¨å“ªï¼Ÿä½ **å¿…é¡»**å¡«å®ƒä»¬çš„åœ°å€æ‰èƒ½è®¿é—®åˆ°å®ƒï¼Œæ¯”å¦‚ï¼š
                * `https://api.deepseek.com/v1`
                * `https://api.openai.com/v1`
                * `https://dashscope.aliyuncs.com/compatible-mode/v1`
                * `https://open.bigmodel.cn/api/paas/v4`

            
            * **Model Name (æ¨¡å‹ä»£å·)**ï¼šâš ï¸ **åƒä¸‡åˆ«å¡«é”™ï¼**
            * è¿™æ˜¯ AI çš„â€œèº«ä»½è¯å·â€ï¼Œå·®ä¸€ä¸ªå­—æ¯ã€å¤§å°å†™éƒ½ä¸è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
            * å¸¸è§ä»£å·ï¼š`deepseek-chat`, `qwen-max`, `gpt-4o`ã€‚
            * **åˆ‡è®°**ï¼šä¸è¦è‡ªå·±ä¹±èµ·åå­—ï¼Œä¸€å®šè¦å»å®˜ç½‘æŸ¥å¯¹åº”çš„ `Model Name`ã€‚
            """)
        
        with c2:
            st.subheader("ğŸ” æ£€ç´¢ä¸RAGé…ç½®")
            st.markdown("""
            * **æ··åˆæ£€ç´¢**ï¼šå¼€å¯åï¼ŒAI ä¼šåŒæ—¶ç”¨â€œå…³é”®è¯åŒ¹é…â€ï¼ˆåƒæŸ¥å­—å…¸ï¼‰å’Œâ€œè¯­ä¹‰ç†è§£â€ï¼ˆåƒè¯»æ‡‚æ„æ€ï¼‰ä¸¤ç§æ–¹å¼æ‰¾ç­”æ¡ˆï¼Œå‡†ç¡®ç‡æ›´é«˜ã€‚
            * **æ··åˆæœç´¢æƒé‡ (Alpha)**ï¼š0åˆ°1ä¹‹é—´ã€‚0.5ä»£è¡¨å¹³è¡¡ã€‚æ¥è¿‘1æ›´åƒæ™®é€šæœç´¢ï¼ˆå…³é”®è¯ï¼‰ï¼Œæ¥è¿‘0æ›´åƒè¯­ä¹‰æœç´¢ã€‚
            * **Top K**ï¼šAI å›ç­”é—®é¢˜æ—¶ï¼Œå‚è€ƒå¤šå°‘ä¸ªæ–‡æ¡£ç‰‡æ®µã€‚é»˜è®¤ 6 ä¸ªã€‚
            * **å‡ºé¢˜å€™é€‰æ± å¤§å°**ï¼šè§£å†³é¢˜ç›®é›·åŒé—®é¢˜ã€‚
                * **éšæœºå‡ºé¢˜å€™é€‰æ± **ï¼šæœªæŒ‡å®šä¸»é¢˜æ—¶ä½¿ç”¨ï¼Œé»˜è®¤ 100ã€‚èŒƒå›´è¶Šå¤§ï¼Œé¢˜ç›®è¶Šä¸é‡å¤ã€‚
                * **æŒ‡å®šä¸»é¢˜å€™é€‰æ± **ï¼šæŒ‡å®šä¸»é¢˜æ—¶ä½¿ç”¨ï¼Œé»˜è®¤ 30ã€‚èŒƒå›´è¶Šå°ï¼Œé¢˜ç›®è¶Šèšç„¦äºè¯¥ä¸»é¢˜ã€‚
            * **å‡ºé¢˜ä¸Šä¸‹æ–‡é•¿åº¦**ï¼šç»™ AI å‡ºé¢˜ç”¨çš„èµ„æ–™é•¿åº¦ã€‚é»˜è®¤ 2000 å­—ç¬¦ã€‚
            * **å¯¹è¯è®°å¿†è½®æ•°**ï¼šAI èƒ½è®°å¾—ä½ä½ ä»¬æœ€è¿‘èŠè¿‡çš„å¤šå°‘å¥è¯ã€‚é»˜è®¤ 10 å¥ã€‚
            """)

            st.subheader("ğŸ–Šï¸ æ–‡æœ¬å¤„ç†é…ç½®")
            st.markdown("""
            * **åˆ‡åˆ†å—å¤§å° (Chunk Size)**ï¼šæŠŠé•¿æ–‡æ¡£åˆ‡æˆå°å—ã€‚é»˜è®¤ 1000 å­—ç¬¦ã€‚å—å¤ªå°æ²¡ä¸Šä¸‹æ–‡ï¼Œå¤ªå¤§æ¨¡å‹åƒä¸æ¶ˆã€‚
            * **é‡å å¤§å° (Overlap)**ï¼šç›¸é‚»ä¸¤ä¸ªå—ä¹‹é—´é‡å¤çš„å†…å®¹é•¿åº¦ï¼Œé˜²æ­¢æŠŠä¸€å¥è¯åˆ‡æ–­ã€‚é»˜è®¤ 200ã€‚
            * **æ¨¡å‹æœ€å¤§ä¸Šä¸‹æ–‡**ï¼šæ¨¡å‹ä¸€æ¬¡èƒ½å¤„ç†çš„æœ€å¤§ Token æ•°ã€‚
            * **é•¿åº¦å®¹é”™ & é‡å å®¹é”™**ï¼šå¾®è°ƒå‚æ•°ã€‚å…è®¸åˆ‡åˆ†æ—¶æœ‰å°‘è®¸è¯¯å·®ï¼Œä¼˜å…ˆä¿è¯å¥å­ä¸è¢«åˆ‡æ–­ã€‚
            """)

        st.subheader("ğŸ› ï¸ å·¥å…·é…ç½®")
        st.markdown("""
        * **Pandoc è·¯å¾„**ï¼š
          * PDF ç”ŸæˆåŠŸèƒ½ä¾èµ– Pandocã€‚ç³»ç»Ÿé€šå¸¸èƒ½è‡ªåŠ¨æ‰¾åˆ°å®ƒã€‚
          * å¦‚æœæç¤ºâ€œæœªæ‰¾åˆ°å‘½ä»¤â€ï¼Œè¯·åœ¨è¿™é‡Œæ‰‹åŠ¨å¡«å…¥ `pandoc` çš„å®Œæ•´è·¯å¾„ï¼ˆä¾‹å¦‚ `/usr/local/bin/pandoc`ï¼‰ã€‚
          * å®‰è£…æ•™ç¨‹ï¼š<a href="https://pandoc.org/installing.html" target="_blank">Pandoc å®˜ç½‘</a>
          * (å¦‚æœé“¾æ¥æ— æ³•ç‚¹å‡»ï¼Œè¯·å¤åˆ¶åœ°å€è‡³æµè§ˆå™¨: `https://pandoc.org/installing.html`)
        """, unsafe_allow_html=True)
        
        st.caption("è®°å¾—ä¿®æ”¹å®Œåç‚¹å‡»æœ€ä¸‹æ–¹çš„ **â€œğŸ’¾ ä¿å­˜å¹¶åº”ç”¨â€** å™¢ï¼")
        
    st.markdown("---")
